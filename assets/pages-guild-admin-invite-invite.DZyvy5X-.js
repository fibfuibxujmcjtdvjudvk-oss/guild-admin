import{_ as t,g as a,r as e,z as s,A as l,s as i,t as n,c as d,w as u,i as c,o,b as r,e as f,p as g,d as _,v as I,x as m,F as h,f as p,h as v,I as y}from"./index-DQwZrAFq.js";import{_ as k}from"./fanhui.DrUZnYcd.js";const b=t({data:()=>({adminInfo:null,guildId:"",guildName:"",guildDbId:"",targetPlanetId:"",sending:!1,inviteHistory:[]}),onLoad(){this.checkLogin()},methods:{checkLogin(){const t=a("guild_admin_info");t&&t.guildId?(this.adminInfo=t,this.guildId=t.guildId,this.guildDbId=t.guildDbId||t.guildId,this.guildName=t.guildName||"",this.loadInviteHistory()):e({url:"/pages/guild-admin/login/login"})},goBack(){s()},copyGuildId(){l({data:this.guildId,success:()=>{i({title:"å·²å¤åˆ¶å…¬ä¼šID",icon:"success"})}})},async sendInvite(){var t,a;if(this.targetPlanetId&&!this.sending){this.sending=!0;try{const e=await n.callFunction({name:"guild-center",data:{action:"sendGuildInvite",guildId:this.guildDbId,guildName:this.guildName,targetUid:this.targetPlanetId}});0===(null==(t=e.result)?void 0:t.code)?(i({title:"é‚€è¯·å·²å‘é€",icon:"success"}),this.targetPlanetId="",this.loadInviteHistory()):i({title:(null==(a=e.result)?void 0:a.message)||"å‘é€å¤±è´¥",icon:"none"})}catch(e){console.error("å‘é€é‚€è¯·å¤±è´¥:",e),i({title:"å‘é€å¤±è´¥",icon:"none"})}finally{this.sending=!1}}},async loadInviteHistory(){var t;try{const a=await n.callFunction({name:"guild-center",data:{action:"getGuildInviteHistory",guildId:this.guildDbId}});0===(null==(t=a.result)?void 0:t.code)&&(this.inviteHistory=a.result.data||[])}catch(a){console.error("åŠ è½½é‚€è¯·è®°å½•å¤±è´¥:",a)}},formatTime(t){if(!t)return"";const a=new Date(t);return`${a.getMonth()+1}/${a.getDate()} ${a.getHours().toString().padStart(2,"0")}:${a.getMinutes().toString().padStart(2,"0")}`},getStatusText:t=>({pending:"å¾…æŽ¥å—",accepted:"å·²æŽ¥å—",rejected:"å·²æ‹’ç»",expired:"å·²è¿‡æœŸ"}[t]||"æœªçŸ¥")}},[["render",function(t,a,e,s,l,i){const n=p,b=c,D=v,x=y;return o(),d(b,{class:"invite-page"},{default:u((()=>[r(b,{class:"nav-header"},{default:u((()=>[r(b,{class:"nav-left",onClick:i.goBack},{default:u((()=>[r(n,{src:k,class:"back-button",mode:"aspectFit"})])),_:1},8,["onClick"]),r(D,{class:"nav-title"},{default:u((()=>[f("é‚€è¯·æˆå‘˜")])),_:1}),r(b,{class:"nav-right"})])),_:1}),r(b,{class:"guild-info-card"},{default:u((()=>[r(b,{class:"info-row"},{default:u((()=>[r(D,{class:"info-label"},{default:u((()=>[f("å…¬ä¼šID")])),_:1}),r(b,{class:"info-value-wrap"},{default:u((()=>[r(D,{class:"info-value"},{default:u((()=>[f(g(l.guildId),1)])),_:1}),r(b,{class:"copy-btn",onClick:i.copyGuildId},{default:u((()=>[r(D,null,{default:u((()=>[f("å¤åˆ¶")])),_:1})])),_:1},8,["onClick"])])),_:1})])),_:1}),r(b,{class:"info-tip"},{default:u((()=>[r(D,null,{default:u((()=>[f("åˆ†äº«å…¬ä¼šIDç»™å¥½å‹ï¼Œå¥½å‹å¯é€šè¿‡æœç´¢å…¬ä¼šIDç”³è¯·åŠ å…¥")])),_:1})])),_:1})])),_:1}),r(b,{class:"invite-section"},{default:u((()=>[r(b,{class:"section-title"},{default:u((()=>[r(D,{class:"title-icon"},{default:u((()=>[f("ðŸ“¨")])),_:1}),r(D,{class:"title-text"},{default:u((()=>[f("å‘é€é‚€è¯·")])),_:1})])),_:1}),r(b,{class:"input-card"},{default:u((()=>[r(b,{class:"input-row"},{default:u((()=>[r(D,{class:"input-label"},{default:u((()=>[f("è¶£å—’ID")])),_:1}),r(x,{class:"input-field",modelValue:l.targetPlanetId,"onUpdate:modelValue":a[0]||(a[0]=t=>l.targetPlanetId=t),placeholder:"è¯·è¾“å…¥å¯¹æ–¹çš„è¶£å—’ID",onConfirm:i.sendInvite},null,8,["modelValue","onConfirm"])])),_:1}),r(b,{class:"input-tip"},{default:u((()=>[r(D,null,{default:u((()=>[f("è¶£å—’IDå¯åœ¨å¯¹æ–¹ä¸ªäººä¸»é¡µæŸ¥çœ‹")])),_:1})])),_:1})])),_:1}),r(b,{class:_(["send-btn",{disabled:!l.targetPlanetId||l.sending}]),onClick:i.sendInvite},{default:u((()=>[r(D,null,{default:u((()=>[f(g(l.sending?"å‘é€ä¸­...":"å‘é€é‚€è¯·"),1)])),_:1})])),_:1},8,["class","onClick"])])),_:1}),r(b,{class:"history-section"},{default:u((()=>[r(b,{class:"section-title"},{default:u((()=>[r(D,{class:"title-icon"},{default:u((()=>[f("ðŸ“‹")])),_:1}),r(D,{class:"title-text"},{default:u((()=>[f("é‚€è¯·è®°å½•")])),_:1})])),_:1}),l.inviteHistory.length>0?(o(),d(b,{key:0,class:"history-list"},{default:u((()=>[(o(!0),I(h,null,m(l.inviteHistory,(t=>(o(),d(b,{class:"history-item",key:t.id},{default:u((()=>[r(n,{class:"user-avatar",src:t.avatar||"/static/default-avatar.png",mode:"aspectFill"},null,8,["src"]),r(b,{class:"user-info"},{default:u((()=>[r(D,{class:"user-name"},{default:u((()=>[f(g(t.nickname),1)])),_:2},1024),r(D,{class:"invite-time"},{default:u((()=>[f(g(i.formatTime(t.createTime)),1)])),_:2},1024)])),_:2},1024),r(b,{class:_(["status-tag",t.status])},{default:u((()=>[r(D,null,{default:u((()=>[f(g(i.getStatusText(t.status)),1)])),_:2},1024)])),_:2},1032,["class"])])),_:2},1024)))),128))])),_:1})):(o(),d(b,{key:1,class:"empty-state"},{default:u((()=>[r(D,{class:"empty-icon"},{default:u((()=>[f("ðŸ“­")])),_:1}),r(D,{class:"empty-text"},{default:u((()=>[f("æš‚æ— é‚€è¯·è®°å½•")])),_:1})])),_:1}))])),_:1})])),_:1})}],["__scopeId","data-v-ae1c1b3e"]]);export{b as default};
