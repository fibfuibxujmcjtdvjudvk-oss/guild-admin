import{_ as a,g as l,r as t,z as s,t as e,j as n,k as o,s as i,c as d,w as c,i as r,o as p,b as u,e as f,v as g,x as v,F as m,f as h,h as _,p as I}from"./index-DQwZrAFq.js";import{_ as k}from"./fanhui.DrUZnYcd.js";const A=a({data:()=>({adminInfo:null,pendingApprovals:[],loading:!1}),onLoad(){this.checkLogin()},onShow(){this.adminInfo&&this.loadPendingApprovals()},methods:{checkLogin(){const a=l("guild_admin_info");a&&a.guildId?(this.adminInfo=a,this.loadPendingApprovals()):t({url:"/pages/guild-admin/login/login"})},goBack(){s()},async loadPendingApprovals(){var a;try{this.loading=!0;const l=await e.callFunction({name:"guild-center",data:{action:"getPendingApprovals",guildId:this.adminInfo.guildDbId||this.adminInfo.guildId}});0===(null==(a=l.result)?void 0:a.code)&&(this.pendingApprovals=l.result.data.list||[])}catch(l){console.error("åŠ è½½å¾…å®¡æ‰¹åˆ—è¡¨å¤±è´¥:",l)}finally{this.loading=!1}},formatTime(a){if(!a)return"";const l=new Date(a),t=new Date-l;return t<6e4?"åˆšåˆš":t<36e5?Math.floor(t/6e4)+"åˆ†é’Ÿå‰":t<864e5?Math.floor(t/36e5)+"å°æ—¶å‰":t<6048e5?Math.floor(t/864e5)+"å¤©å‰":`${l.getMonth()+1}/${l.getDate()}`},async handleApproval(a,l){var t,s;try{n({title:l?"åŒæ„ä¸­...":"æ‹’ç»ä¸­..."});const d=await e.callFunction({name:"guild-center",data:{action:"handleJoinApproval",guildId:this.adminInfo.guildDbId||this.adminInfo.guildId,applicationId:a._id,userId:a.user_id,approved:l}});o(),0===(null==(t=d.result)?void 0:t.code)?(i({title:l?"å·²åŒæ„åŠ å…¥":"å·²æ‹’ç»ç”³è¯·",icon:"success"}),this.loadPendingApprovals()):i({title:(null==(s=d.result)?void 0:s.message)||"æ“ä½œå¤±è´¥",icon:"none"})}catch(d){o(),console.error("å¤„ç†å®¡æ‰¹å¤±è´¥:",d),i({title:"æ“ä½œå¤±è´¥",icon:"none"})}}}},[["render",function(a,l,t,s,e,n){const o=h,i=r,A=_;return p(),d(i,{class:"approval-page"},{default:c((()=>[u(i,{class:"nav-header"},{default:c((()=>[u(i,{class:"nav-left",onClick:n.goBack},{default:c((()=>[u(o,{src:k,class:"back-button",mode:"aspectFit"})])),_:1},8,["onClick"]),u(A,{class:"nav-title"},{default:c((()=>[f("å…¥ä¼šå®¡æ‰¹")])),_:1}),u(i,{class:"nav-right"})])),_:1}),e.pendingApprovals.length>0?(p(),d(i,{key:0,class:"approval-list"},{default:c((()=>[(p(!0),g(m,null,v(e.pendingApprovals,(a=>(p(),d(i,{class:"approval-item",key:a._id},{default:c((()=>[u(o,{class:"approval-avatar",src:a.avatar||"/static/default-avatar.png",mode:"aspectFill"},null,8,["src"]),u(i,{class:"approval-info"},{default:c((()=>[u(A,{class:"approval-name"},{default:c((()=>[f(I(a.nickname||"ç”¨æˆ·"),1)])),_:2},1024),u(A,{class:"approval-time"},{default:c((()=>[f(I(n.formatTime(a.create_time)),1)])),_:2},1024)])),_:2},1024),u(i,{class:"approval-actions"},{default:c((()=>[u(i,{class:"action-btn reject",onClick:l=>n.handleApproval(a,!1)},{default:c((()=>[u(A,null,{default:c((()=>[f("æ‹’ç»")])),_:1})])),_:2},1032,["onClick"]),u(i,{class:"action-btn accept",onClick:l=>n.handleApproval(a,!0)},{default:c((()=>[u(A,null,{default:c((()=>[f("åŒæ„")])),_:1})])),_:2},1032,["onClick"])])),_:2},1024)])),_:2},1024)))),128))])),_:1})):(p(),d(i,{key:1,class:"empty-state"},{default:c((()=>[u(A,{class:"empty-icon"},{default:c((()=>[f("ðŸŽ‰")])),_:1}),u(A,{class:"empty-text"},{default:c((()=>[f("æš‚æ— å¾…å®¡æ‰¹ç”³è¯·")])),_:1}),u(A,{class:"empty-desc"},{default:c((()=>[f("æ–°çš„å…¥ä¼šç”³è¯·å°†ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ")])),_:1})])),_:1})),u(i,{class:"safe-bottom"})])),_:1})}],["__scopeId","data-v-b71873f1"]]);export{A as default};
